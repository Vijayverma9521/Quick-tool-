<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Tool App</title>
    <style>
        /* CSS कोड */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        :root { --primary-bg: #f4f7fa; --secondary-bg: #ffffff; --accent-color: #3b82f6; --text-color: #334155; --light-text-color: #f8fafc; --border-color: #e2e8f0; --shadow: 0 4px 12px rgba(0, 0, 0, 0.08); --header-height: 60px; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* --- MODIFIED FOR SCROLLING --- */
        body { 
            font-family: 'Poppins', sans-serif; 
            background-color: var(--primary-bg); 
            color: var(--text-color); 
            height: 100vh; 
            display: flex; 
            flex-direction: column;
            /* overflow: hidden; has been REMOVED from here to allow main content to scroll properly */
        }
        
        .app-header { display: flex; justify-content: space-between; align-items: center; padding: 0 20px; height: var(--header-height); background-color: var(--secondary-bg); border-bottom: 1px solid var(--border-color); flex-shrink: 0; }
        .app-header .app-title { font-size: 20px; margin: 0; }
        
        .main-content { 
            flex-grow: 1; 
            overflow-y: auto; /* This will now correctly handle the scrolling for all content */
            padding: 20px; 
        }

        /* The rest of the CSS remains the same */
        .tool-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .tool-card { background-color: var(--secondary-bg); border-radius: 16px; padding: 20px 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; box-shadow: var(--shadow); cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .tool-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .tool-card svg { width: 40px; height: 40px; margin-bottom: 12px; }
        .tool-card span { font-size: 14px; font-weight: 500; }
        @media (min-width: 768px) { .tool-grid { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); } }
        .tool-panel { display: none; animation: fadeIn 0.4s ease-in-out; }
        .tool-panel.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .tool-header { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
        .back-btn { background: var(--primary-bg); border: 1px solid var(--border-color); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .back-btn svg { width: 24px; height: 24px; }
        .card { background-color: var(--secondary-bg); border-radius: 16px; padding: 25px; box-shadow: var(--shadow); margin-top: 10px; }
        .page-title { font-size: 22px; font-weight: 600; color: var(--text-color); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 500; margin-bottom: 8px; font-size: 14px; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px 15px; border: 1px solid var(--border-color); border-radius: 10px; font-size: 16px; transition: all 0.3s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
        .btn { background-color: var(--accent-color); color: var(--light-text-color); border: none; padding: 14px 20px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; width: 100%; }
        .btn:hover { background-color: #2563eb; transform: translateY(-2px); }
        .result-box { margin-top: 25px; padding: 20px; background-color: #eef2ff; border-radius: 10px; border-left: 5px solid var(--accent-color); }
        .lang-toggle { display: flex; align-items: center; gap: 5px; }
        .lang-toggle span { font-size: 14px; font-weight: 500; }
        .switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent-color); }
        input:checked + .slider:before { transform: translateX(20px); }
        .sip-tabs { display:flex; margin-bottom: 20px; border-bottom: 2px solid var(--border-color); }
        .sip-tab { padding: 10px 15px; cursor: pointer; font-weight: 500; border-bottom: 3px solid transparent; margin-bottom: -2px; }
        .sip-tab.active { color: var(--accent-color); border-bottom-color: var(--accent-color); }
        .sip-content { display: none; } .sip-content.active { display: block; }
        .stopwatch-display { font-size: 48px; font-weight: 700; text-align: center; margin-bottom: 20px; font-family: 'Courier New', Courier, monospace; }
        .stopwatch-controls { display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; }
        .laps { max-height: 200px; overflow-y: auto; border-top: 1px solid var(--border-color); padding-top: 10px; }
        .laps div { display: flex; justify-content: space-between; padding: 8px 5px; border-bottom: 1px solid #eef2ff; }
        .notes-container { display: flex; gap: 20px; min-height: 400px; }
        .notes-list { width: 30%; border-right: 1px solid var(--border-color); padding-right: 20px; max-height: 400px; overflow-y: auto; }
        .note-item { padding: 10px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; border: 1px solid transparent; display:flex; justify-content:space-between; align-items:center; }
        .note-item:hover, .note-item.active { background-color: #eef2ff; border-color: var(--accent-color); }
        .note-title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-grow: 1; }
        .note-delete-btn { background:none; border:none; color:#EF4444; cursor:pointer; padding:5px; display:none; flex-shrink: 0; }
        .note-item:hover .note-delete-btn { display:inline-block; }
        .notes-editor { width: 70%; display: flex; flex-direction: column; }
        #notes-textarea { flex-grow: 1; resize: none; border: none; background: #fbfdff; padding: 10px; border-radius: 8px; }
        #notes-textarea:focus { outline: none; box-shadow: 0 0 0 2px var(--accent-color) inset; }
        .forecast-container { display: flex; overflow-x: auto; gap: 10px; padding: 10px 0; }
        .forecast-day { flex: 0 0 80px; text-align: center; background: #eef2ff; padding: 10px; border-radius: 10px; }
        .forecast-day img { width: 40px; height: 40px; }
        .forecast-day .day { font-weight: 600; }
        
        /* --- AD BLOCKER CSS --- */
        #adBlockerOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.9); color: white; z-index: 9999;
            display: none; justify-content: center; align-items: center; text-align: center;
            flex-direction: column; padding: 20px;
        }
        #adBlockerOverlay h2 { font-size: 24px; margin-bottom: 15px; }
        #adBlockerOverlay p { font-size: 18px; line-height: 1.6; }
        .ad-bait { height: 1px !important; width: 1px !important; position: absolute !important; left: -9999px !important; top: -9999px !important; visibility: hidden !important; }
        
        /* --- ADVERTISING CSS --- */
        .ad-container {
            display: flex; justify-content: center; align-items: center;
            margin: 15px auto; min-height: 50px; width: 100%; max-width: 320px;
            background-color: #e0e0e0; border-radius: 10px;
        }
        .native-ad-wrapper {
            margin-top: 20px; padding: 10px;
            background-color: var(--secondary-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            display: flex; justify-content: center; align-items: center;
        }

    </style>
</head>
<body>

    <!-- Ad Blocker Bait and Overlay -->
    <div class="ad-bait" id="ad-bait"></div>
    <div id="adBlockerOverlay">
        <div>
            <h2>Ad Blocker Detected!</h2>
            <p>इस एप्लिकेशन को चलाने के लिए कृपया अपना ऐड-ब्लॉकर अक्षम करें।<br>Please disable your Ad-Blocker to run this application.</p>
        </div>
    </div>
    
    <div id="app-container"> <!-- Main App Wrapper -->
        <header class="app-header">
            <h1 class="app-title" data-lang-key="homeTitle"></h1>
            <div class="lang-toggle">
                <span>हिं</span>
                <label class="switch"><input type="checkbox" id="langToggle"><span class="slider"></span></label>
                <span>En</span>
            </div>
        </header>

        <main class="main-content">
            <!-- Home Panel -->
            <div id="home" class="tool-panel active">
                <!-- Top Banner Ad -->
                <div class="ad-container">
                    <script type="text/javascript">
                        atOptions = { 'key' : '93d262ecbf218277a12b4db296b975e9', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
                    </script>
                    <script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script>
                </div>
                
                <!-- Tool Grid -->
                <div class="tool-grid">
                    <!-- JS will fill this with tool cards -->
                </div>
                
                <!-- Native Ad Wrapper at the Bottom -->
                <div class="native-ad-wrapper">
                    <!-- JS will fill this with the native ad -->
                </div>
            </div>

            <!-- All Tool Panels -->
            <div id="sip" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="sipTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="sip-tabs"><div class="sip-tab active" data-tab="monthly-sip" data-lang-key="monthlySip"></div><div class="sip-tab" data-tab="lumpsum-sip" data-lang-key="lumpsumSip"></div></div><div id="monthly-sip" class="sip-content active"><div class="form-group"><label for="monthlyInvestment" data-lang-key="monthlyInvestmentLabel"></label><input type="number" id="monthlyInvestment" value="5000"></div><div class="form-group"><label for="sipExpectedReturn" data-lang-key="expectedReturnLabel"></label><input type="number" id="sipExpectedReturn" value="12"></div><div class="form-group"><label for="sipTimePeriod" data-lang-key="timePeriodLabel"></label><input type="number" id="sipTimePeriod" value="10"></div><button class="btn" id="calculateSIPBtn" data-lang-key="calculateBtn"></button></div><div id="lumpsum-sip" class="sip-content"><div class="form-group"><label for="lumpsumInvestment" data-lang-key="lumpsumInvestmentLabel"></label><input type="number" id="lumpsumInvestment" value="100000"></div><div class="form-group"><label for="lumpsumExpectedReturn" data-lang-key="expectedReturnLabel"></label><input type="number" id="lumpsumExpectedReturn" value="12"></div><div class="form-group"><label for="lumpsumTimePeriod" data-lang-key="timePeriodLabel"></label><input type="number" id="lumpsumTimePeriod" value="10"></div><button class="btn" id="calculateLumpsumBtn" data-lang-key="calculateBtn"></button></div><div id="sipResult" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="age" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="ageTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="dob" data-lang-key="dobLabel"></label><input type="date" id="dob"></div><button class="btn" id="calculateAgeBtn" data-lang-key="calculateAgeBtn"></button><div id="ageResult" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="gst" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="gstTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="gstAmount" data-lang-key="amountLabel"></label><input type="number" id="gstAmount" data-lang-key="amountPlaceholder" placeholder=""></div><div class="form-group"><label data-lang-key="gstRateLabel"></label><select id="gstRate"><option value="5">5%</option><option value="12">12%</option><option value="18" selected>18%</option><option value="28">28%</option></select></div><button class="btn" id="calculateGSTBtn" data-lang-key="calculateBtn"></button><div id="gstResult" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="qr" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="qrTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="qrText" data-lang-key="textOrUrlLabel"></label><textarea id="qrText" rows="4" data-lang-key="qrPlaceholder" placeholder=""></textarea></div><button class="btn" id="generateQRBtn" data-lang-key="generateQRBtn"></button><div id="qrcode" style="display: flex; justify-content: center; align-items: center; margin-top: 20px; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; min-height: 256px;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="password" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="passwordTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="passwordLength" data-lang-key="passwordLengthLabel"></label><input type="range" id="passwordLength" min="8" max="32" value="16" oninput="this.nextElementSibling.value = this.value"><output>16</output></div><div class="form-group"><label style="display:inline-flex; align-items:center; gap: 8px;"><input type="checkbox" id="includeNumbers" checked><span data-lang-key="includeNumbersLabel"></span></label><br><label style="display:inline-flex; align-items:center; gap: 8px;"><input type="checkbox" id="includeSymbols" checked><span data-lang-key="includeSymbolsLabel"></span></label></div><button class="btn" id="generatePasswordBtn" data-lang-key="generatePasswordBtn"></button><div class="result-box"><h3 data-lang-key="yourPasswordLabel"></h3><div style="display:flex; align-items: center; background: var(--primary-bg); padding: 10px; border-radius: 8px; margin-top: 10px;"><input type="text" id="passwordOutput" readonly style="flex-grow: 1; border: none; background: transparent; font-size: 18px; font-family: 'Courier New', Courier, monospace;"><button id="copyPasswordBtn" style="background: none; border: none; cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3z"/></svg></button></div></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="weather" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="weatherTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="cityInput" data-lang-key="cityLabel"></label><input type="text" id="cityInput" data-lang-key="cityPlaceholder" placeholder=""></div><button class="btn" id="getWeatherBtn" data-lang-key="getWeatherBtn"></button><div id="weatherResult" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="fuel-cost" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="fuelTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="distance" data-lang-key="distanceLabel"></label><input type="number" id="distance" placeholder="e.g., 250"></div><div class="form-group"><label for="mileage" data-lang-key="mileageLabel"></label><input type="number" id="mileage" placeholder="e.g., 18"></div><div class="form-group"><label for="fuel-price" data-lang-key="fuelPriceLabel"></label><input type="number" id="fuel-price" placeholder="e.g., 97"></div><button class="btn" id="calculateFuelCostBtn" data-lang-key="calculateBtn"></button><div id="fuel-result" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="currency" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="currencyTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="currency-amount" data-lang-key="amountLabel"></label><input type="number" id="currency-amount" value="1"></div><div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;"><div class="form-group" style="flex:1; margin:0;"><label for="from-currency" data-lang-key="fromLabel"></label><select id="from-currency"></select></div><svg id="swapCurrenciesBtn" style="width:24px; height:24px; cursor:pointer; margin-top:20px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" /></svg><div class="form-group" style="flex:1; margin:0;"><label for="to-currency" data-lang-key="toLabel"></label><select id="to-currency"></select></div></div><button class="btn" id="convertCurrencyBtn" data-lang-key="convertBtn"></button><div id="currency-result" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="jewelry" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="jewelryTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="gold-weight" data-lang-key="weightLabel"></label><input type="number" id="gold-weight" placeholder="e.g., 10"></div><div class="form-group"><label for="gold-karat" data-lang-key="purityLabel"></label><select id="gold-karat"><option value="24">24K</option><option value="22" selected>22K</option><option value="18">18K</option><option value="14">14K</option></select></div><div class="form-group"><label for="gold-rate" data-lang-key="goldRateLabel"></label><input type="number" id="gold-rate" placeholder="e.g., 70000"></div><div class="form-group"><label for="making-charges" data-lang-key="makingChargesLabel"></label><input type="number" id="making-charges" placeholder="e.g., 12"></div><button class="btn" id="calculateJewelryBtn" data-lang-key="calculateBtn"></button><div id="jewelry-result" class="result-box" style="display:none;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="stopwatch" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="stopwatchTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="stopwatch-display" id="stopwatch-display">00:00:00.00</div><div class="stopwatch-controls"><button class="btn" id="start-stop-btn" data-lang-key="startBtn"></button><button class="btn" id="lap-reset-btn" data-lang-key="lapBtn" disabled></button></div><div class="laps" id="laps-container"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="unit-converter" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="unitConverterTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="unit-category" data-lang-key="categoryLabel"></label><select id="unit-category"></select></div><div class="form-group"><label for="unit-input-value" data-lang-key="valueLabel"></label><input type="number" id="unit-input-value" value="1"></div><div style="display: flex; align-items: center; gap: 10px;"><div class="form-group" style="flex:1; margin:0;"><label for="from-unit" data-lang-key="fromLabel"></label><select id="from-unit"></select></div><div style="margin-top:25px; font-weight:bold;">=</div><div class="form-group" style="flex:1; margin:0;"><label for="to-unit" data-lang-key="toLabel"></label><select id="to-unit"></select></div></div><div id="unit-result" class="result-box" style="margin-top: 20px;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="easy-notes" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="notesTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div style="margin-bottom: 15px;"><button class="btn" id="addNewNoteBtn" data-lang-key="addNewNote"></button></div><div class="notes-container"><div class="notes-list" id="notes-list"></div><div class="notes-editor"><textarea id="notes-textarea" data-lang-key="notesPlaceholder"></textarea></div></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
            <div id="time-zone" class="tool-panel">
                <div class="tool-header"><button class="back-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg></button><h2 class="page-title" data-lang-key="timeZoneTitle"></h2></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
                <div class="card"><div class="form-group"><label for="timezone-select" data-lang-key="selectZoneLabel"></label><select id="timezone-select"></select></div><div id="timezone-result" class="result-box" style="text-align:center;"></div></div>
                <div class="ad-container"><script type="text/javascript">atOptions={'key':'93d262ecbf218277a12b4db296b975e9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/93d262ecbf218277a12b4db296b975e9/invoke.js"></script></div>
            </div>
        </main>
    </div> <!-- End of app-container -->
    
    <!-- QR Code Generator Library -->
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>

    <script>
        const App = {
            // --- STATE AND CONFIG ---
            currentLang: localStorage.getItem('appLanguage') || 'hi',
            currencyRates: {},
            st: { timer: null, running: false, startTime: 0, elapsedTime: 0, laps: [] },
            notes: [],
            activeNoteId: null,
            tzInterval: null,
            qrGenerator: null,

            translations: {
                en: { homeTitle: "All Tools", sipTool: "SIP Calculator", ageTool: "Age Calculator", gstTool: "GST Calculator", qrTool: "QR Generator", passwordTool: "Password Gen", weatherTool: "Weather", fuelTool: "Fuel Cost", currencyTool: "Currency", jewelryTool: "Jewelry Price", stopwatchTool: "Stopwatch", unitConverterTool: "Unit Converter", notesTool: "Easy Notes", timeZoneTool: "Time Zones", calculateBtn: "Calculate", convertBtn: "Convert", fromLabel: "From", toLabel: "To", valueLabel: "Value", categoryLabel: "Category", clearBtn: "Clear", fuelTitle: "Fuel Cost Calculator", distanceLabel: "Distance (km)", mileageLabel: "Vehicle Mileage (km/L)", fuelPriceLabel: "Fuel Price (per Litre)", totalFuelNeeded: "Total Fuel Needed", totalTripCost: "Total Trip Cost", currencyTitle: "Currency Converter", amountLabel: "Amount", loadingCurrencies: "Loading currencies...", apiError: "API Error", jewelryTitle: "Jewelry Price Calculator", weightLabel: "Weight (grams)", purityLabel: "Purity (Karat)", goldRateLabel: "Gold Rate (per 10 grams)", makingChargesLabel: "Making Charges (%)", goldPrice: "Gold Price", makingChargesCost: "Making Charges", subTotal: "Sub Total", gstAmount: "GST (3%)", totalCost: "Total Cost", stopwatchTitle: "Stopwatch", startBtn: "Start", stopBtn: "Stop", lapBtn: "Lap", resetBtn: "Reset", unitConverterTitle: "Unit Converter", length: "Length", mass: "Mass", temperature: "Temperature", notesTitle: "Easy Notes", notesPlaceholder: "Write your notes here...", noteSaved: "Note saved!", addNewNote: "Add New Note", newNoteTitle: "New Note", timeZoneTitle: "Time Zone Converter", selectZoneLabel: "Select a Time Zone", sipTitle: "SIP / Lumpsum Calculator", monthlySip: "Monthly SIP", lumpsumSip: "Lumpsum", monthlyInvestmentLabel: "Monthly Investment (₹)", expectedReturnLabel: "Expected Return Rate (% p.a.)", timePeriodLabel: "Time Period (Years)", resultInvested: "Invested Amount", resultGains: "Estimated Gains", resultTotal: "Total Value", ageTitle: "Age Calculator", dobLabel: "Your Date of Birth", calculateAgeBtn: "Calculate Age", yourAgeIs: "Your age is", years: "Years", months: "Months", days: "Days", gstTitle: "GST Calculator", gstRateLabel: "GST Rate (%)", gstCalcTitle: "GST Calculation", gstAdd: "On Adding GST:", totalAmount: "Total Amount", gstRemove: "On Removing GST (if included):", baseAmount: "Base Amount", qrTitle: "QR Code Generator", textOrUrlLabel: "Text or URL", qrPlaceholder: "Enter your text or website link here", generateQRBtn: "Generate QR Code", passwordTitle: "Password Generator", passwordLengthLabel: "Password Length", includeNumbersLabel: " Include Numbers (0-9)", includeSymbolsLabel: " Include Symbols (@#$%)", generatePasswordBtn: "Generate New Password", yourPasswordLabel: "Your Secure Password:", passwordCopied: "Password copied!", generateFirst: "Generate a password first.", weatherTitle: "Weather Information", cityLabel: "City Name", cityPlaceholder: "e.g., Mumbai, Delhi", getWeatherBtn: "Get Weather", loadingWeather: "Loading weather data...", cityNotFound: "City not found or network issue.", humidity: "Humidity", wind: "Wind", pressure: "Pressure", forecastTitle: "10-Day Forecast", detectingLocation: "Detecting your location..." },
                hi: { homeTitle: "सभी टूल्स", sipTool: "SIP कैलकुलेटर", ageTool: "आयु कैलकुलेटर", gstTool: "GST कैलकुलेटर", qrTool: "QR जेनरेटर", passwordTool: "पासवर्ड जेनरेटर", weatherTool: "मौसम", fuelTool: "ईंधन लागत", currencyTool: "मुद्रा परिवर्तक", jewelryTool: "आभूषण मूल्य", stopwatchTool: "स्टॉपवॉच", unitConverterTool: "इकाई परिवर्तक", notesTool: "आसान नोट्स", timeZoneTool: "समय क्षेत्र", calculateBtn: "गणना करें", convertBtn: "बदलें", fromLabel: "से", toLabel: "में", valueLabel: "मान", categoryLabel: "श्रेणी", clearBtn: "साफ़ करें", fuelTitle: "ईंधन लागत कैलकुलेटर", distanceLabel: "दूरी (किमी)", mileageLabel: "गाड़ी का माइलेज (किमी/लीटर)", fuelPriceLabel: "ईंधन की कीमत (प्रति लीटर)", totalFuelNeeded: "कुल ईंधन की आवश्यकता", totalTripCost: "यात्रा की कुल लागत", currencyTitle: "मुद्रा परिवर्तक", amountLabel: "राशि", loadingCurrencies: "मुद्राएं लोड हो रही हैं...", apiError: "API त्रुटि", jewelryTitle: "आभूषण मूल्य कैलकुलेटर", weightLabel: "वजन (ग्राम)", purityLabel: "शुद्धता (कैरेट)", goldRateLabel: "सोने का भाव (प्रति 10 ग्राम)", makingChargesLabel: "मेकिंग चार्ज (%)", goldPrice: "सोने की कीमत", makingChargesCost: "मेकिंग चार्ज", subTotal: "उप-योग", gstAmount: "जीएसटी (3%)", totalCost: "कुल लागत", stopwatchTitle: "स्टॉपवॉच", startBtn: "शुरू", stopBtn: "रोकें", lapBtn: "लैप", resetBtn: "रीसेट", unitConverterTitle: "इकाई परिवर्तक", length: "लंबाई", mass: "द्रव्यमान", temperature: "तापमान", notesTitle: "आसान नोट्स", notesPlaceholder: "अपने नोट्स यहां लिखें...", noteSaved: "नोट सेव हो गया!", addNewNote: "नया नोट जोड़ें", newNoteTitle: "नया नोट", timeZoneTitle: "समय क्षेत्र परिवर्तक", selectZoneLabel: "एक समय क्षेत्र चुनें", sipTitle: "SIP / एकमुश्त कैलक्यूलेटर", monthlySip: "मासिक SIP", lumpsumSip: "एकमुश्त", monthlyInvestmentLabel: "मासिक निवेश (₹)", expectedReturnLabel: "अपेक्षित रिटर्न दर (% प्रति वर्ष)", timePeriodLabel: "समय अवधि (वर्ष)", resultInvested: "निवेश की गई राशि", resultGains: "अनुमानित रिटर्न", resultTotal: "कुल संपत्ति", ageTitle: "आयु कैलक्यूलेटर", dobLabel: "आपकी जन्म तिथि", calculateAgeBtn: "आयु की गणना करें", yourAgeIs: "आपकी आयु है", years: "वर्ष", months: "महीने", days: "दिन", gstTitle: "GST कैलक्यूलेटर", gstRateLabel: "GST दर (%)", gstCalcTitle: "GST गणना", gstAdd: "GST जोड़ने पर:", totalAmount: "कुल राशि", gstRemove: "GST हटाने पर (यदि राशि में शामिल है):", baseAmount: "मूल राशि", qrTitle: "QR कोड जेनरेटर", textOrUrlLabel: "टेक्स्ट या URL", qrPlaceholder: "यहाँ अपना टेक्स्ट या वेबसाइट का लिंक डालें", generateQRBtn: "QR कोड बनाएं", passwordTitle: "पासवर्ड जेनरेटर", passwordLengthLabel: "पासवर्ड की लंबाई", includeNumbersLabel: " नंबर शामिल करें (0-9)", includeSymbolsLabel: " सिंबल शामिल करें (@#$%)", generatePasswordBtn: "नया पासवर्ड बनाएं", yourPasswordLabel: "आपका सुरक्षित पासवर्ड:", passwordCopied: "पासवर्ड कॉपी हो गया!", generateFirst: "पहले पासवर्ड जेनरेट करें।", weatherTitle: "मौसम की जानकारी", cityLabel: "शहर का नाम", cityPlaceholder: "जैसे: Mumbai, Delhi", getWeatherBtn: "मौसम देखें", loadingWeather: "मौसम की जानकारी लोड हो रही है...", cityNotFound: "शहर नहीं मिला या नेटवर्क में समस्या है।", humidity: "नमी", wind: "हवा", pressure: "दबाव", forecastTitle: "10-दिन का पूर्वानुमान", detectingLocation: "आपकी लोकेशन पता की जा रही है..." }
            },
            tools: [
                { id: 'sip', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" /></svg>`, nameKey: 'sipTool', color: '#10B981' }, { id: 'currency', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`, nameKey: 'currencyTool', color: '#16A34A' }, { id: 'jewelry', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" /></svg>`, nameKey: 'jewelryTool', color: '#FBBF24' }, { id: 'fuel-cost', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 12.572l.463.268a6 6 0 006.562-3.238l.01-.027l.01-.027a6 6 0 00-3.238-6.562l-.268-.463M16.5 12.572l-.463.268a6 6 0 01-6.562-3.238l-.01-.027l-.01-.027a6 6 0 013.238-6.562l.268-.463M12 21a9 9 0 100-18 9 9 0 000 18z" /></svg>`, nameKey: 'fuelTool', color: '#0284C7' }, { id: 'stopwatch', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`, nameKey: 'stopwatchTool', color: '#EA580C' }, { id: 'unit-converter', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 6.75A2.25 2.25 0 015.25 4.5h13.5A2.25 2.25 0 0121 6.75v10.5A2.25 2.25 0 0118.75 19.5H5.25A2.25 2.25 0 013 17.25V6.75z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6.75h.008v.008h-.008v-.008z" /></svg>`, nameKey: 'unitConverterTool', color: '#DC2626' }, { id: 'easy-notes', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>`, nameKey: 'notesTool', color: '#CA8A04' }, { id: 'time-zone', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9 9 0 110-18c1.657 0 3.16.672 4.243 1.757m0 0l3.156-3.156m-3.156 3.156L15 3.75M3 12a9 9 0 1118 0" /></svg>`, nameKey: 'timeZoneTool', color: '#4F46E5' }, { id: 'age', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 12.75h.008v.008H12v-.008z" /></svg>`, nameKey: 'ageTool', color: '#3B82F6' }, { id: 'gst', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M14.25 7.756a4.5 4.5 0 100 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`, nameKey: 'gstTool', color: '#991B1B' }, { id: 'qr', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.5A.75.75 0 014.5 3.75h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-4.5a.75.75 0 01-.75-.75v-4.5zM3.75 14.25a.75.75 0 01.75-.75h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-4.5a.75.75 0 01-.75-.75v-4.5zM13.5 4.5a.75.75 0 01.75-.75h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-4.5a.75.75 0 01-.75-.75v-4.5zM13.5 14.25a.75.75 0 01.75-.75h4.5a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-4.5a.75.75 0 01-.75-.75v-4.5z" /></svg>`, nameKey: 'qrTool', color: '#22C55E' }, { id: 'password', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" /></svg>`, nameKey: 'passwordTool', color: '#8B5CF6' }, { id: 'weather', icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.5 4.5 0 002.25 15z" /></svg>`, nameKey: 'weatherTool', color: '#0EA5E9' }
            ],
            unitData: { length: { 'm': 1, 'km': 1000, 'cm': 0.01, 'mm': 0.001, 'mi': 1609.34, 'ft': 0.3048, 'in': 0.0254 }, mass: { 'g': 1, 'kg': 1000, 'mg': 0.001, 't': 1000000, 'lb': 453.592 }, temperature: { 'c': 'c', 'f': 'f', 'k': 'k' }},
            currencyNames: { "USD":"US Dollar","EUR":"Euro","JPY":"Japanese Yen","GBP":"British Pound","AUD":"Australian Dollar","CAD":"Canadian Dollar","CHF":"Swiss Franc","CNY":"Chinese Yuan","SEK":"Swedish Krona","NZD":"New Zealand Dollar","MXN":"Mexican Peso","SGD":"Singapore Dollar","HKD":"Hong Kong Dollar","NOK":"Norwegian Krone","KRW":"South Korean Won","TRY":"Turkish Lira","RUB":"Russian Ruble","INR":"Indian Rupee","BRL":"Brazilian Real","ZAR":"South African Rand","AED":"UAE Dirham","AFN":"Afghan Afghani","ALL":"Albanian Lek","AMD":"Armenian Dram","ANG":"Netherlands Antillean Guilder","AOA":"Angolan Kwanza","ARS":"Argentine Peso","AWG":"Aruban Florin","AZN":"Azerbaijani Manat","BAM":"Bosnia-Herzegovina Convertible Mark","BBD":"Barbadian Dollar","BDT":"Bangladeshi Taka","BGN":"Bulgarian Lev","BHD":"Bahraini Dinar","BIF":"Burundian Franc","BMD":"Bermudian Dollar","BND":"Brunei Dollar","BOB":"Bolivian Boliviano","BSD":"Bahamian Dollar","BTN":"Bhutanese Ngultrum","BWP":"Botswanan Pula","BYN":"Belarusian Ruble","BZD":"Belize Dollar","CDF":"Congolese Franc","CLP":"Chilean Peso","COP":"Colombian Peso","CRC":"Costa Rican Colón","CUP":"Cuban Peso","CVE":"Cape Verdean Escudo","CZK":"Czech Koruna","DJF":"Djiboutian Franc","DKK":"Danish Krone","DOP":"Dominican Peso","DZD":"Algerian Dinar","EGP":"Egyptian Pound","ERN":"Eritrean Nakfa","ETB":"Ethiopian Birr","FJD":"Fijian Dollar","FKP":"Falkland Islands Pound","FOK":"Faroese Króna","GEL":"Georgian Lari","GGP":"Guernsey Pound","GHS":"Ghanaian Cedi","GIP":"Gibraltar Pound","GMD":"Gambian Dalasi","GNF":"Guinean Franc","GTQ":"Guatemalan Quetzal","GYD":"Guyanaese Dollar","HNL":"Honduran Lempira","HRK":"Croatian Kuna","HTG":"Haitian Gourde","HUF":"Hungarian Forint","IDR":"Indonesian Rupee","ILS":"Israeli New Shekel","IMP":"Manx pound","IQD":"Iraqi Dinar","IRR":"Iranian Rial","ISK":"Icelandic Króna","JEP":"Jersey Pound","JMD":"Jamaican Dollar","JOD":"Jordanian Dinar","KES":"Kenyan Shilling","KGS":"Kyrgystani Som","KHR":"Cambodian Riel","KID":"Kiribati Dollar","KMF":"Comorian Franc","KWD":"Kuwaiti Dinar","KYD":"Cayman Islands Dollar","KZT":"Kazakhstani Tenge","LAK":"Laotian Kip","LBP":"Lebanese Pound","LKR":"Sri Lankan Rupee","LRD":"Liberian Dollar","LSL":"Lesotho Loti","LYD":"Libyan Dinar","MAD":"Moroccan Dirham","MDL":"Moldovan Leu","MGA":"Malagasy Ariary","MKD":"Macedonian Denar","MMK":"Myanma Kyat","MNT":"Mongolian Tugrik","MOP":"Macanese Pataca","MRU":"Mauritanian Ouguiya","MUR":"Mauritian Rupee","MVR":"Maldivian Rufiyaa","MWK":"Malawian Kwacha","MYR":"Malaysian Ringgit","MZN":"Mozambican Metical","NAD":"Namibian Dollar","NGN":"Nigerian Naira","NIO":"Nicaraguan Córdoba","NPR":"Nepalese Rupee","OMR":"Omani Rial","PAB":"Panamanian Balboa","PEN":"Peruvian Nuevo Sol","PGK":"Papua New Guinean Kina","PHP":"Philippine Peso","PKR":"Pakistani Rupee","PLN":"Polish Zloty","PYG":"Paraguayan Guarani","QAR":"Qatari Rial","RON":"Romanian Leu","RSD":"Serbian Dinar","RWF":"Rwandan Franc","SAR":"Saudi Riyal","SBD":"Solomon Islands Dollar","SCR":"Seychellois Rupee","SDG":"Sudanese Pound","SHP":"Saint Helena Pound","SLE":"Sierra Leonean Leone","SLL":"Sierra Leonean Leone","SOS":"Somali Shilling","SRD":"Surinamese Dollar","SSP":"South Sudanese Pound","STN":"São Tomé and Príncipe Dobra","SYP":"Syrian Pound","SZL":"Swazi Lilangeni","THB":"Thai Baht","TJS":"Tajikistani Somoni","TMT":"Turkmenistani Manat","TND":"Tunisian Dinar","TOP":"Tongan Paʻanga","TTD":"Trinidad and Tobago Dollar","TVD":"Tuvaluan Dollar","TWD":"New Taiwan Dollar","TZS":"Tanzanian Shilling","UAH":"Ukrainian Hryvnia","UGX":"Ugandan Shilling","UYU":"Uruguayan Peso","UZS":"Uzbekistan Som","VES":"Venezuelan Bolívar","VND":"Vietnamese Dong","VUV":"Vanuatu Vatu","WST":"Samoan Tala","XAF":"CFA Franc BEAC","XCD":"East Caribbean Dollar","XDR":"Special Drawing Rights","XOF":"CFA Franc BCEAO","XPF":"CFP Franc","YER":"Yemeni Rial","ZMW":"Zambian Kwacha","ZWL":"Zimbabwean Dollar" },

            // --- APP METHODS ---
            init() { 
                if (this.detectAdBlocker()) { return; }
                try {
                    this.buildHomeScreen(); 
                    this.bindEventListeners(); 
                    const unitCategorySelect = document.getElementById('unit-category');
                    if (unitCategorySelect) {
                        unitCategorySelect.innerHTML = ''; 
                        Object.keys(this.unitData).forEach(category => {
                            const option = document.createElement('option');
                            option.value = category;
                            option.setAttribute('data-lang-key', category); 
                            unitCategorySelect.appendChild(option);
                        });
                    }
                    this.setLanguage(this.currentLang); 
                    this.showTool('home'); 
                    this.generatePassword(); 
                    this.updateUnitOptions();       
                } catch (e) {
                    console.error("App initialization error:", e);
                }
            },
            
            detectAdBlocker() {
                const adBait = document.getElementById('ad-bait');
                if (!adBait || adBait.offsetHeight === 0 || adBait.offsetParent === null || getComputedStyle(adBait).display === 'none') {
                    document.getElementById('adBlockerOverlay').style.display = 'flex';
                    document.getElementById('app-container').style.display = 'none';
                    return true;
                }
                return false;
            },

            injectNativeAd() {
                try {
                    const nativeAdWrapper = document.querySelector('.native-ad-wrapper');
                    if (!nativeAdWrapper) { return; }
                    nativeAdWrapper.innerHTML = '';
                    const adScript = document.createElement('script');
                    adScript.async = true;
                    adScript.setAttribute('data-cfasync', 'false');
                    adScript.src = '//pl27124501.profitableratecpm.com/392a7ed3f3c4cd86eefebc3ff398d610/invoke.js';
                    const adContainer = document.createElement('div');
                    adContainer.id = 'container-392a7ed3f3c4cd86eefebc3ff398d610';
                    nativeAdWrapper.appendChild(adScript);
                    nativeAdWrapper.appendChild(adContainer);
                } catch (e) {
                    console.error("Native ad injection error:", e);
                }
            },

            buildHomeScreen() {
                try {
                    const gridContainer = document.querySelector('.tool-grid');
                    gridContainer.innerHTML = ''; 
                    this.tools.forEach(tool => {
                        const card = document.createElement('div');
                        card.className = 'tool-card';
                        card.innerHTML = `${tool.icon.replace('<svg', `<svg style="color: ${tool.color};"`)}<span data-lang-key="${tool.nameKey}"></span>`;
                        card.addEventListener('click', () => this.showTool(tool.id));
                        gridContainer.appendChild(card);
                    });
                    this.injectNativeAd();
                } catch (e) {
                    console.error("Home screen build error:", e);
                }
            },
            
            setLanguage(lang) { 
                try {
                    this.currentLang = lang; 
                    localStorage.setItem('appLanguage', lang); 
                    document.documentElement.lang = lang; 
                    document.querySelectorAll('[data-lang-key]').forEach(el => { 
                        const key = el.getAttribute('data-lang-key'), 
                              translation = this.translations[this.currentLang][key]; 
                        if (translation) { 
                            if (el.placeholder !== undefined && el.tagName !== 'SPAN') 
                                el.placeholder = translation; 
                            else 
                                el.innerHTML = translation; 
                        }
                    }); 
                    document.getElementById('langToggle').checked = lang === 'en'; 
                } catch (e) {
                    console.error("Language setting error:", e);
                }
            },
            
            showTool(toolId) { 
                try {
                    clearInterval(this.tzInterval); 
                    this.stopStopwatch(true); 
                    document.querySelectorAll('.tool-panel').forEach(p => p.classList.remove('active')); 
                    document.getElementById(toolId).classList.add('active'); 
                    document.querySelector('.app-header').style.display = (toolId === 'home') ? 'flex' : 'none'; 
                    document.querySelector('.main-content').scrollTop = 0; 
                    if(toolId === 'currency' && Object.keys(this.currencyRates).length === 0) { this.initCurrencyConverter(); } 
                    if(toolId === 'easy-notes'){ this.loadNotes(); } 
                    if(toolId === 'time-zone'){ this.initTimezone(); } 
                } catch (e) {
                    console.error(`Error showing tool ${toolId}:`, e);
                }
            },
            
            formatToIndianRupees: (num) => new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 2 }).format(num),
            
            calculateSIP: () => { 
                try {
                    const P = parseFloat(document.getElementById('monthlyInvestment').value), 
                          r = parseFloat(document.getElementById('sipExpectedReturn').value) / 100, 
                          t = parseFloat(document.getElementById('sipTimePeriod').value); 
                    if (isNaN(P) || isNaN(r) || isNaN(t)) return; 
                    const M = P * (Math.pow(1 + (r / 12), t * 12) - 1) / (r / 12) * (1 + (r / 12)), 
                          investedAmount = P * t * 12, 
                          wealthGained = M - investedAmount, 
                          resultDiv = document.getElementById('sipResult'); 
                    resultDiv.innerHTML = `<h3>${App.translations[App.currentLang].resultTotal}: <span>${App.formatToIndianRupees(M)}</span></h3><p>${App.translations[App.currentLang].resultInvested}: ${App.formatToIndianRupees(investedAmount)}</p><p>${App.translations[App.currentLang].resultGains}: ${App.formatToIndianRupees(wealthGained)}</p>`; 
                    resultDiv.style.display = 'block'; 
                } catch (e) { console.error("SIP calculation error:", e); }
            },
            
            calculateLumpsum: () => { 
                try {
                    const P = parseFloat(document.getElementById('lumpsumInvestment').value), 
                          r = parseFloat(document.getElementById('lumpsumExpectedReturn').value) / 100, 
                          t = parseFloat(document.getElementById('lumpsumTimePeriod').value); 
                    if (isNaN(P) || isNaN(r) || isNaN(t)) return; 
                    const M = P * Math.pow((1 + r), t), 
                          wealthGained = M - P, 
                          resultDiv = document.getElementById('sipResult'); 
                    resultDiv.innerHTML = `<h3>${App.translations[App.currentLang].resultTotal}: <span>${App.formatToIndianRupees(M)}</span></h3><p>${App.translations[App.currentLang].resultInvested}: ${App.formatToIndianRupees(P)}</p><p>${App.translations[App.currentLang].resultGains}: ${App.formatToIndianRupees(wealthGained)}</p>`; 
                    resultDiv.style.display = 'block'; 
                } catch (e) { console.error("Lumpsum calculation error:", e); }
            },
            
            calculateAge: () => { 
                try {
                    const dobString = document.getElementById('dob').value; 
                    if (!dobString) return; 
                    const birthDate = new Date(dobString), today = new Date(); 
                    let years = today.getFullYear() - birthDate.getFullYear(), 
                        months = today.getMonth() - birthDate.getMonth(), 
                        days = today.getDate() - birthDate.getDate(); 
                    if (days < 0) { months--; days += new Date(today.getFullYear(), today.getMonth(), 0).getDate(); } 
                    if (months < 0) { years--; months += 12; } 
                    const resultDiv = document.getElementById('ageResult'); 
                    resultDiv.innerHTML = `<h3>${App.translations[App.currentLang].yourAgeIs}:</h3><p><span>${years}</span> ${App.translations[App.currentLang].years}, <span>${months}</span> ${App.translations[App.currentLang].months}, <span>${days}</span> ${App.translations[App.currentLang].days}</p>`; 
                    resultDiv.style.display = 'block'; 
                } catch (e) { console.error("Age calculation error:", e); }
            },
            
            calculateGST: () => { 
                try {
                    const amount = parseFloat(document.getElementById('gstAmount').value), 
                          rate = parseFloat(document.getElementById('gstRate').value); 
                    if (isNaN(amount)) return; 
                    const gstAmount = amount * (rate / 100), 
                          totalAmount = amount + gstAmount, 
                          preGstAmount = amount / (1 + (rate / 100)), 
                          gstRemovedAmount = amount - preGstAmount, 
                          resultDiv = document.getElementById('gstResult'); 
                    resultDiv.innerHTML = `<h3 style="margin-bottom:5px;">${App.translations[App.currentLang].gstCalcTitle}</h3><p><strong>${App.translations[App.currentLang].gstAdd}</strong></p><ul><li>${App.translations[App.currentLang].gstAmount}: ${App.formatToIndianRupees(gstAmount)}</li><li>${App.translations[App.currentLang].totalAmount}: ${App.formatToIndianRupees(totalAmount)}</li></ul><br><p><strong>${App.translations[App.currentLang].gstRemove}</strong></p><ul><li>${App.translations[App.currentLang].baseAmount}: ${App.formatToIndianRupees(preGstAmount)}</li><li>${App.translations[App.currentLang].gstAmount}: ${App.formatToIndianRupees(gstRemovedAmount)}</li></ul>`; 
                    resultDiv.style.display = 'block'; 
                } catch (e) { console.error("GST calculation error:", e); }
            },
            
            generateQR: () => { 
                try {
                    const text = document.getElementById('qrText').value; 
                    if (!text) return; 
                    const qrContainer = document.getElementById('qrcode'); 
                    qrContainer.innerHTML = ""; 
                    App.qrGenerator = new QRCode(qrContainer, { text: text, width: 250, height: 250, colorDark : "#000000", colorLight : "#ffffff", correctLevel : QRCode.CorrectLevel.H }); 
                } catch (e) { console.error("QR generation error:", e); }
            },
            
            generatePassword: () => { 
                try {
                    const length = document.getElementById('passwordLength').value; 
                    let charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; 
                    if (document.getElementById('includeNumbers').checked) charset += '0123456789'; 
                    if (document.getElementById('includeSymbols').checked) charset += '!@#$%^&*()_+~`|}{[]?'; 
                    let password = ''; 
                    for (let i = 0; i < length; i++) password += charset.charAt(Math.floor(Math.random() * charset.length)); 
                    document.getElementById('passwordOutput').value = password; 
                } catch (e) { console.error("Password generation error:", e); }
            },
            
            copyPassword: () => { 
                try {
                    const passField = document.getElementById('passwordOutput'); 
                    if(!passField.value) { alert(App.translations[App.currentLang].generateFirst); return; } 
                    passField.select(); 
                    document.execCommand('copy'); 
                    alert(App.translations[App.currentLang].passwordCopied); 
                } catch (e) { console.error("Password copy error:", e); }
            },
            
            getWeather: async (city) => { 
                const resultDiv = document.getElementById('weatherResult'); 
                try {
                    resultDiv.style.display = 'block'; 
                    resultDiv.innerHTML = `<p>${App.translations[App.currentLang].loadingWeather}</p>`; 
                    const apiKey = 'eeb9e1b8913d423e42ca86e4183d70c3'; 
                    const currentUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=${App.currentLang}`; 
                    const currentResponse = await fetch(currentUrl); 
                    if (!currentResponse.ok) throw new Error(App.translations[App.currentLang].cityNotFound); 
                    const currentData = await currentResponse.json(); 
                    const { lat, lon } = currentData.coord; 
                    const forecastUrl = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=auto&forecast_days=10`; 
                    const forecastResponse = await fetch(forecastUrl); 
                    const forecastData = await forecastResponse.json(); 
                    let forecastHTML = `<div class="forecast-container">`; 
                    forecastData.daily.time.forEach((day, index) => { 
                        const date = new Date(day); 
                        const dayName = date.toLocaleDateString(App.currentLang, { weekday: 'short' }); 
                        forecastHTML += `<div class="forecast-day"><div>${dayName}</div><img src="https://openweathermap.org/img/wn/${App.getWeatherIconFromCode(forecastData.daily.weathercode[index])}@2x.png" alt=""><div><strong>${Math.round(forecastData.daily.temperature_2m_max[index])}°</strong> ${Math.round(forecastData.daily.temperature_2m_min[index])}°</div></div>`;}); 
                    forecastHTML += `</div>`; 
                    resultDiv.innerHTML = `<div style="text-align:center;"><h2>${currentData.name}, ${currentData.sys.country}</h2><img src="https://openweathermap.org/img/wn/${currentData.weather[0].icon}@2x.png" alt="weather icon" style="width:80px; height:80px;"><p style="font-size: 42px; font-weight: 700;">${Math.round(currentData.main.temp)}°C</p><p style="font-size: 18px; text-transform: capitalize; margin-top: -10px;">${currentData.weather[0].description}</p><div style="display: flex; justify-content: space-around; margin-top: 20px;"><div><strong>${App.translations[App.currentLang].humidity}</strong><p>${currentData.main.humidity}%</p></div><div><strong>${App.translations[App.currentLang].wind}</strong><p>${currentData.wind.speed} m/s</p></div><div><strong>${App.translations[App.currentLang].pressure}</strong><p>${currentData.main.pressure} hPa</p></div></div></div><hr style="margin:20px 0;"><h3 style="text-align:center; margin-bottom:10px;">${App.translations[App.currentLang].forecastTitle}</h3>${forecastHTML}`; 
                } catch (error) { resultDiv.innerHTML = `<p style="color:red;">${error.message}</p>`; } 
            },
            
            getWeatherByCoords: async (lat, lon) => { 
                try {
                    document.getElementById('cityInput').value = App.translations[App.currentLang].detectingLocation; 
                    const apiKey = 'eeb9e1b8913d423e42ca86e4183d70c3'; 
                    const cityUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`; 
                    const response = await fetch(cityUrl); 
                    const data = await response.json(); 
                    if(data.name) { document.getElementById('cityInput').value = data.name; App.getWeather(data.name); } 
                } catch(e) { console.error("Error fetching city from coords:", e); } 
            },
            
            getWeatherIconFromCode: (code) => { 
                if ([0, 1].includes(code)) return '01d'; if ([2].includes(code)) return '02d'; if ([3].includes(code)) return '03d';
                if ([45, 48].includes(code)) return '50d'; if ([51, 53, 55, 61, 63, 65, 80, 81, 82].includes(code)) return '09d';
                if ([56, 57, 66, 67].includes(code)) return '13d'; if ([71, 73, 75, 77, 85, 86].includes(code)) return '13d';
                if ([95, 96, 99].includes(code)) return '11d'; return '01d'; 
            },
            
            calculateFuelCost: () => { 
                try {
                    const dist = parseFloat(document.getElementById('distance').value), 
                          mil = parseFloat(document.getElementById('mileage').value), 
                          price = parseFloat(document.getElementById('fuel-price').value); 
                    if(isNaN(dist) || isNaN(mil) || isNaN(price)) return; 
                    const fuelNeeded = dist / mil, totalCost = fuelNeeded * price; 
                    document.getElementById('fuel-result').innerHTML = `<p>${App.translations[App.currentLang].totalFuelNeeded}: ${fuelNeeded.toFixed(2)} Litres</p><p>${App.translations[App.currentLang].totalTripCost}: ${App.formatToIndianRupees(totalCost)}</p>`; 
                    document.getElementById('fuel-result').style.display = 'block'; 
                } catch (e) { console.error("Fuel cost calculation error:", e); }
            },
            
            initCurrencyConverter: async () => { 
                const fromSelect = document.getElementById('from-currency'), toSelect = document.getElementById('to-currency'); 
                try {
                    fromSelect.innerHTML = `<option>${App.translations[App.currentLang].loadingCurrencies}</option>`; 
                    const apiKey = '455da4db74356781a71cee46'; 
                    const response = await fetch(`https://v6.exchangerate-api.com/v6/${apiKey}/latest/USD`); 
                    if (!response.ok) throw new Error('API Error'); 
                    const data = await response.json(); 
                    if (data.result === 'error') throw new Error(data['error-type']); 
                    App.currencyRates = data.conversion_rates; 
                    fromSelect.innerHTML = ''; toSelect.innerHTML = ''; 
                    Object.keys(App.currencyRates).sort().forEach(code => { 
                        const name = App.currencyNames[code] || code; 
                        const optionHTML = `<option value="${code}">${code} - ${name}</option>`; 
                        fromSelect.innerHTML += optionHTML; toSelect.innerHTML += optionHTML; 
                    }); 
                    fromSelect.value = "USD"; toSelect.value = "INR"; App.convertCurrency(); 
                } catch (e) { fromSelect.innerHTML = `<option>${App.translations[App.currentLang].apiError}</option>`; console.error(e); } 
            },
            
            convertCurrency: () => { 
                try {
                    const amount = parseFloat(document.getElementById('currency-amount').value), 
                          from = document.getElementById('from-currency').value, 
                          to = document.getElementById('to-currency').value; 
                    if(isNaN(amount) || !App.currencyRates[from]) return; 
                    const result = (amount / App.currencyRates[from]) * App.currencyRates[to]; 
                    document.getElementById('currency-result').innerHTML = `<p>${amount} ${from} = <strong>${result.toFixed(4)} ${to}</strong></p>`; 
                    document.getElementById('currency-result').style.display = 'block'; 
                } catch (e) { console.error("Currency conversion error:", e); }
            },
            
            swapCurrencies: () => { 
                try {
                    const from = document.getElementById('from-currency'), to = document.getElementById('to-currency'); 
                    [from.value, to.value] = [to.value, from.value]; App.convertCurrency(); 
                } catch (e) { console.error("Currency swap error:", e); }
            },
            
            calculateJewelry: () => { 
                try {
                    const weight = parseFloat(document.getElementById('gold-weight').value), karat = parseFloat(document.getElementById('gold-karat').value), 
                          rate = parseFloat(document.getElementById('gold-rate').value), making = parseFloat(document.getElementById('making-charges').value); 
                    if([weight, karat, rate, making].some(isNaN)) return; 
                    const goldCost = (weight * (karat/24)) * (rate/10), makingCost = goldCost * (making/100), 
                          subTotal = goldCost + makingCost, gst = subTotal * 0.03, total = subTotal + gst; 
                    document.getElementById('jewelry-result').innerHTML = `<ul style="list-style:none; padding:0;"><li>${App.translations[App.currentLang].goldPrice}: <span>${App.formatToIndianRupees(goldCost)}</span></li><li style="margin-top:5px;">${App.translations[App.currentLang].makingChargesCost}: <span>${App.formatToIndianRupees(makingCost)}</span></li><li style="margin-top:5px;">${App.translations[App.currentLang].subTotal}: <span>${App.formatToIndianRupees(subTotal)}</span></li><li style="margin-top:5px;">${App.translations[App.currentLang].gstAmount}: <span>${App.formatToIndianRupees(gst)}</span></li><hr style="margin:10px 0;"><li style="font-weight:bold; font-size:1.1em;">${App.translations[App.currentLang].totalCost}: <span>${App.formatToIndianRupees(total)}</span></li></ul>`; 
                    document.getElementById('jewelry-result').style.display = 'block'; 
                } catch (e) { console.error("Jewelry calculation error:", e); }
            },
            
            startStopwatch: () => { 
                try {
                    const startStopBtn = document.getElementById('start-stop-btn'), lapResetBtn = document.getElementById('lap-reset-btn'); 
                    App.st.running = !App.st.running; 
                    if (App.st.running) { 
                        App.st.startTime = Date.now() - App.st.elapsedTime; 
                        App.st.timer = setInterval(App.updateStopwatch, 10); 
                        startStopBtn.textContent = App.translations[App.currentLang].stopBtn; 
                        lapResetBtn.textContent = App.translations[App.currentLang].lapBtn; 
                        lapResetBtn.disabled = false; 
                    } else { 
                        clearInterval(App.st.timer); 
                        App.st.elapsedTime = Date.now() - App.st.startTime; 
                        startStopBtn.textContent = App.translations[App.currentLang].startBtn; 
                        lapResetBtn.textContent = App.translations[App.currentLang].resetBtn; 
                    } 
                } catch (e) { console.error("Stopwatch start error:", e); }
            },
            
            updateStopwatch: () => { 
                try {
                    const elapsed = Date.now() - App.st.startTime,
                        ms = String(Math.floor((elapsed % 1000) / 10)).padStart(2, '0'),
                        secs = String(Math.floor((elapsed / 1000) % 60)).padStart(2, '0'),
                        mins = String(Math.floor((elapsed / (1000 * 60)) % 60)).padStart(2, '0');
                    document.getElementById('stopwatch-display').textContent = `${mins}:${secs}.${ms}`; 
                } catch (e) { console.error("Stopwatch update error:", e); }
            },
            
            lapResetStopwatch: () => { 
                try {
                    if (App.st.running) { 
                        const lapTime = document.getElementById('stopwatch-display').textContent; App.st.laps.push(lapTime); 
                        const lapsContainer = document.getElementById('laps-container'); 
                        lapsContainer.innerHTML = `<div><span>Lap ${App.st.laps.length}</span><span>${lapTime}</span></div>` + lapsContainer.innerHTML; 
                    } else { App.stopStopwatch(true); } 
                } catch (e) { console.error("Stopwatch lap/reset error:", e); }
            },
            
            stopStopwatch: (reset) => { 
                try {
                    clearInterval(App.st.timer); 
                    if(reset) { 
                        App.st = { timer: null, running: false, startTime: 0, elapsedTime: 0, laps: [] }; 
                        document.getElementById('stopwatch-display').textContent = '00:00:00.00'; 
                        document.getElementById('start-stop-btn').textContent = App.translations[App.currentLang].startBtn; 
                        document.getElementById('lap-reset-btn').textContent = App.translations[App.currentLang].lapBtn; 
                        document.getElementById('lap-reset-btn').disabled = true; 
                        document.getElementById('laps-container').innerHTML = ''; 
                    } 
                } catch (e) { console.error("Stopwatch stop error:", e); }
            },
            
            updateUnitOptions: () => { 
                try {
                    const cat = document.getElementById('unit-category').value, from = document.getElementById('from-unit'), to = document.getElementById('to-unit');
                    if (!cat) return; 
                    from.innerHTML = to.innerHTML = ''; 
                    Object.keys(App.unitData[cat]).forEach(unit => { 
                        from.innerHTML += `<option value="${unit}">${unit}</option>`; to.innerHTML += `<option value="${unit}">${unit}</option>`; 
                    }); App.convertUnits(); 
                } catch (e) { console.error("Unit options update error:", e); }
            },
            
            convertUnits: () => { 
                try {
                    const cat = document.getElementById('unit-category').value, val = parseFloat(document.getElementById('unit-input-value').value),
                        from = document.getElementById('from-unit').value, to = document.getElementById('to-unit').value; 
                    if(isNaN(val) || !from || !to) { document.getElementById('unit-result').textContent = ''; return; } 
                    let result; 
                    if(cat === 'temperature') { 
                        if(from === to) result = val; 
                        else if(from === 'c') result = to === 'f' ? (val * 9/5) + 32 : val + 273.15; 
                        else if(from === 'f') result = to === 'c' ? (val - 32) * 5/9 : ((val - 32) * 5/9) + 273.15; 
                        else result = to === 'c' ? val - 273.15 : ((val - 273.15) * 9/5) + 32; 
                    } else { 
                        const baseValue = val * App.unitData[cat][from]; result = baseValue / App.unitData[cat][to]; 
                    } 
                    document.getElementById('unit-result').textContent = `${val} ${from} = ${result.toFixed(3)} ${to}`; 
                } catch (e) { console.error("Unit conversion error:", e); }
            },
            
            loadNotes: () => { 
                try {
                    App.notes = JSON.parse(localStorage.getItem('easy-notes-multi')) || []; 
                    const list = document.getElementById('notes-list'); list.innerHTML = ''; 
                    App.notes.forEach(note => { 
                        const item = document.createElement('div'); item.className = 'note-item'; item.dataset.id = note.id; 
                        item.innerHTML = `<span class="note-title">${note.content.substring(0,20).replace(/\n/g, ' ') || App.translations[App.currentLang].newNoteTitle}</span><button class="note-delete-btn">×</button>`; 
                        item.addEventListener('click', () => App.openNote(note.id)); 
                        item.querySelector('.note-delete-btn').addEventListener('click', (e) => { e.stopPropagation(); App.deleteNote(note.id); }); 
                        list.appendChild(item); 
                    }); 
                    if (App.notes.length === 0) { App.addNewNote(); } 
                    else if (!App.activeNoteId || !App.notes.find(n => n.id === App.activeNoteId)) { App.openNote(App.notes[0].id); } 
                    else { App.openNote(App.activeNoteId); } 
                } catch (e) { console.error("Notes load error:", e); }
            },
            
            openNote: (id) => { 
                try {
                    const note = App.notes.find(n => n.id === id); 
                    if(note) { 
                        App.activeNoteId = id; 
                        document.getElementById('notes-textarea').value = note.content; 
                        document.querySelectorAll('.note-item').forEach(i => i.classList.remove('active')); 
                        const activeItem = document.querySelector(`.note-item[data-id="${id}"]`); 
                        if (activeItem) activeItem.classList.add('active'); 
                    } 
                } catch (e) { console.error("Note open error:", e); }
            },
            
            saveActiveNote: () => { 
                try {
                    const content = document.getElementById('notes-textarea').value; 
                    const note = App.notes.find(n => n.id === App.activeNoteId); 
                    if(note) { 
                        note.content = content; 
                        localStorage.setItem('easy-notes-multi', JSON.stringify(App.notes)); 
                        const title = document.querySelector(`.note-item[data-id="${App.activeNoteId}"] .note-title`); 
                        if(title) title.textContent = content.substring(0,20).replace(/\n/g, ' ') || App.translations[App.currentLang].newNoteTitle; 
                    } 
                } catch (e) { console.error("Note save error:", e); }
            },
            
            addNewNote: () => { 
                try {
                    const newNote = { id: Date.now().toString(), content: '' }; 
                    App.notes.unshift(newNote); App.activeNoteId = newNote.id; 
                    App.loadNotes(); document.getElementById('notes-textarea').focus(); 
                } catch (e) { console.error("Add note error:", e); }
            },
            
            deleteNote: (id) => { 
                try {
                    App.notes = App.notes.filter(n => n.id !== id); 
                    localStorage.setItem('easy-notes-multi', JSON.stringify(App.notes)); 
                    if(App.activeNoteId === id) App.activeNoteId = null; App.loadNotes(); 
                } catch (e) { console.error("Delete note error:", e); }
            },
            
            initTimezone: async () => { 
                const select = document.getElementById('timezone-select');
                try { 
                    if (select.options.length > 1) { App.updateTimezone(); return; } 
                    if(Intl && Intl.supportedValuesOf) { 
                        const timezones = Intl.supportedValuesOf('timeZone'); 
                        timezones.sort().forEach(tz => select.innerHTML += `<option value="${tz}">${tz.replace(/_/g, ' ')}</option>`); 
                        select.value = Intl.DateTimeFormat().resolvedOptions().timeZone || "Asia/Kolkata"; 
                    } else { throw new Error("Timezone API fallback needed"); }
                    select.onchange = App.updateTimezone; App.updateTimezone(); 
                    clearInterval(App.tzInterval); App.tzInterval = setInterval(App.updateTimezone, 1000); 
                } catch(e) { console.error(e); select.innerHTML=`<option>${App.translations[App.currentLang].apiError}</option>` } 
            },
            
            updateTimezone: () => { 
                try {
                    const tz = document.getElementById('timezone-select').value; if(!tz) return; 
                    const date = new Date(), 
                          time = date.toLocaleTimeString(App.currentLang.startsWith('hi') ? 'hi-IN' : 'en-US', {timeZone: tz, hour12:true, hour:'2-digit', minute:'2-digit', second:'2-digit'}), 
                          d = date.toLocaleDateString(App.currentLang.startsWith('hi') ? 'hi-IN' : 'en-US', {timeZone: tz, weekday:'long', year:'numeric', month:'long', day:'numeric'}); 
                    document.getElementById('timezone-result').innerHTML = `<p style="font-size:2.5em; margin-bottom: 5px; font-weight:600;">${time}</p><p>${d}</p>`; 
                } catch (e) { console.error("Timezone update error:", e); }
            },

            bindEventListeners() {
                try {
                    document.getElementById('langToggle').addEventListener('change', (e) => this.setLanguage(e.target.checked ? 'en' : 'hi'));
                    document.querySelectorAll('.back-btn').forEach(btn => btn.addEventListener('click', () => this.showTool('home')));
                    document.getElementById('calculateSIPBtn').addEventListener('click', () => this.calculateSIP());
                    document.getElementById('calculateLumpsumBtn').addEventListener('click', () => this.calculateLumpsum());
                    document.getElementById('calculateAgeBtn').addEventListener('click', () => this.calculateAge());
                    document.getElementById('calculateGSTBtn').addEventListener('click', () => this.calculateGST());
                    document.getElementById('generateQRBtn').addEventListener('click', () => this.generateQR());
                    document.getElementById('generatePasswordBtn').addEventListener('click', () => this.generatePassword());
                    document.getElementById('copyPasswordBtn').addEventListener('click', () => this.copyPassword());
                    document.getElementById('getWeatherBtn').addEventListener('click', () => { const city = document.getElementById('cityInput').value; if(city) this.getWeather(city); });
                    document.getElementById('calculateFuelCostBtn').addEventListener('click', () => this.calculateFuelCost());
                    document.getElementById('convertCurrencyBtn').addEventListener('click', () => this.convertCurrency());
                    document.getElementById('swapCurrenciesBtn').addEventListener('click', () => this.swapCurrencies());
                    document.getElementById('calculateJewelryBtn').addEventListener('click', () => this.calculateJewelry());
                    document.getElementById('addNewNoteBtn').addEventListener('click', () => this.addNewNote());
                    document.getElementById('notes-textarea').addEventListener('input', () => this.saveActiveNote());
                    document.getElementById('start-stop-btn').addEventListener('click', () => this.startStopwatch());
                    document.getElementById('lap-reset-btn').addEventListener('click', () => this.lapResetStopwatch());
                    document.querySelectorAll('.sip-tab').forEach(tab => {
                        tab.addEventListener('click', (e) => {
                            const parent = e.target.parentElement;
                            parent.querySelectorAll('.sip-tab').forEach(t => t.classList.remove('active'));
                            e.target.classList.add('active');
                            const contentId = e.target.dataset.tab;
                            parent.parentElement.querySelectorAll('.sip-content').forEach(c => c.classList.remove('active'));
                            document.getElementById(contentId).classList.add('active');
                        });
                    });
                    document.getElementById('unit-category').addEventListener('change', () => this.updateUnitOptions());
                    document.getElementById('unit-input-value').addEventListener('input', () => this.convertUnits());
                    document.getElementById('from-unit').addEventListener('change', () => this.convertUnits());
                    document.getElementById('to-unit').addEventListener('change', () => this.convertUnits());
                } catch (e) {
                    console.error("Event listener binding error:", e);
                }
            }
        };

        // --- START THE APP ---
        document.addEventListener('DOMContentLoaded', () => {
            App.init();
        });
    </script>
</body>
</html>